INCLUDE "emu8086.inc"

TAMANHO EQU 32 
TAMANHO_OPCAO EQU 2

org 100h

DEFINE_GET_STRING
DEFINE_PRINT_STRING       
    
    HELLO:
        
    CALL CLEAR_SCREEN
    
    MOV SI, OFFSET ALUNO
    CALL PRINT_STRING
    CALL PULA_LINHA
     
    MOV SI, OFFSET ALUNO1
    CALL PRINT_STRING
    CALL PULA_LINHA
    
    MOV SI, OFFSET ALUNO2
    CALL PRINT_STRING
    CALL PULA_LINHA
    
    MOV SI, OFFSET ALUNO3
    CALL PRINT_STRING
    CALL PULA_LINHA
                   
    CALL PULA_LINHA
    MOV SI, OFFSET INICIAR_PROGRAMA
    CALL PRINT_STRING
                
    MOV DI, OFFSET OPCAO_CACA_PALAVRAS
    MOV DX, TAMANHO +1
    CALL GET_STRING
    
    CALL INICIO_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS
    MOV BX, 0000
    JMP INICIO_ 
    
    INICIO:
        MOV BX, 0000 
        MOV BX, [INDICE]
        ADD BX, 2
        CMP BX, 56
        JE  FINALIZAR_PROGRAMA
        JMP INICIO_
    INICIO_:
    CALL CLEAR_SCREEN
    MOV INDICE, BX
    MOV SI, PONTEIRO_PALAVRAS[BX]
    CALL CONTAR_PALAVRA_ENTRADA  
    PUSH SI
    
    MOV SI, OFFSET PROCURANDO_PALAVRA
    CALL PRINT_STRING
    MOV SI, PONTEIRO_PALAVRAS[BX]
    CALL PRINT_STRING 
    CALL PULA_LINHA
    
    POP SI
    PUSH BX
    JMP PROCURA_ESQUERDA_DIREITA       
               
INDICE DW 0000 
QTD_LETRAS DW 0000 ,0
                 
;INICIO CONTAR QUANTIDADE DE LETRAS DA PALAVRA A SER LOCALIZADA
CONTAR_PALAVRA_ENTRADA:
    PUSHF
    PUSH DX
    PUSH CX
    MOV CX, 0000
CONTANDO:
    MOV DL, [SI]
    CMP DL, 0
    JE RETORNA
    INC SI 
    INC CX
    JMP CONTANDO 
RETORNA:        
    MOV QUANTIDADE_DE_LETRAS_PALAVRA, CL 
    MOV QTD_LETRAS, CX
    POP CX
    POP DX 
    POPF
    RET
;FIM CONTAR QUANTIDADE DE LETRAS DA PALAVRA A SER LOCALIZADA                             
    
                             
;INICIO ESQUERDA PARA DIREITA
PROCURA_ESQUERDA_DIREITA:
    PUSHF  
    PUSH DX
    PUSH CX   
    MOV BX, 0000 
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    MOV DI, OFFSET INICIO_A
    INC DI
PROCURANDO_ESQUERDA_DIREITA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  ESQUERDA_DIREITA_BACKUP
    INC PRIMEIRA_LETRA
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_M
PROCURANDO_ESQUERDA_DIREITA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]  
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH, "#"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    MOV DI, CX
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_DIREITA_IGUAIS:
    INC SI
    INC DI
    JMP PROCURANDO_ESQUERDA_DIREITA_PALAVRA
ESQUERDA_DIREITA_BACKUP:
    MOV CX, DI   
    INC PRIMEIRA_LETRA
    JMP  PROCURANDO_ESQUERDA_DIREITA_PALAVRA
ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA: 
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA:
    MOV COR, 7
    MOV DH, [DI]
    INC LETRA_ATUAL       
    CMP DH, "@"
    JE  PROXIMA_LINHA_ESQUERDA_DIREITA
    CMP DH, "*"
    JE  FIM_PROCURA_ESQUERDA_DIREITA
    MOV SI, [PRIMEIRA_LETRA] 
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA]
    CMP [LETRA_ATUAL], SI
    JE  ESQUERDA_DIREITA_IMPRIMIR_PALAVRA
    CALL IMPRIMIR_LETRA
    INC DI 
    JMP IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA
ESQUERDA_DIREITA_IMPRIMIR_PALAVRA:
    MOV DH, [DI]
    MOV COR, 2 
    CMP CH, 0
    JE  IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA
    CALL IMPRIMIR_LETRA
    INC DI
    DEC CH 
    JMP ESQUERDA_DIREITA_IMPRIMIR_PALAVRA 
PROXIMA_LINHA_ESQUERDA_DIREITA:
    ADD DI, 2 
    INC LETRA_ATUAL
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CACA_PALAVRAS_ESQUERDA_DIREITA
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_DIREITA:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_DIREITA_ESQUERDA
FIM_PROCURA_ESQUERDA_DIREITA: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO  
;FIM ESQUERDA PARA DIREITA


;INICIO DIREITA PARA ESQUERDA
PROCURA_DIREITA_ESQUERDA:
    PUSHF 
    PUSH DX
    PUSH CX    
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX] 
    MOV DI, OFFSET INICIO_B
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2 
    ADD DI, CX 
PROCURANDO_DIREITA_ESQUERDA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA_AJUSTAR
    CMP DH, "!"
    JE  PULAR_LINHA_DIREITA_ESQUERDA
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA 
    CMP DH,DL
    JE  DIREITA_ESQUERDA_BACKUP
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX 
    INC PRIMEIRA_LETRA
    DEC DI
    JMP PROCURANDO_DIREITA_ESQUERDA_M
PROCURANDO_DIREITA_ESQUERDA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA_AJUSTAR
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_ESQUERDA_IGUAIS
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    MOV DI, CX
    DEC DI
    CALL DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA
    INC PRIMEIRA_LETRA 
    JMP PROCURANDO_DIREITA_ESQUERDA_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_ESQUERDA_IGUAIS:
    INC SI
    DEC DI
    INC PRIMEIRA_LETRA 
    INC DEC_PRIMEIRA_LETRA
    JMP PROCURANDO_DIREITA_ESQUERDA_PALAVRA
DIREITA_ESQUERDA_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_DIREITA_ESQUERDA_PALAVRA
PULAR_LINHA_DIREITA_ESQUERDA:
    SUB DI, 2
    JMP PROCURANDO_DIREITA_ESQUERDA_M
DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA:
    DEC PRIMEIRA_LETRA                                  
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA
    JMP DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA
SAIR_DECREMENTAR_PRIMEIRA_LETRA_DIREITA_ESQUERDA:
    RET
ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA_AJUSTAR:
    PUSH CX
    MOV CX, [QUANTIDADE_DE_LETRAS]
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA:    
    CALL PULA_LINHA 
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA:
    MOV COR, 7
    MOV DH, [DI]      
    CMP DH, "@"
    JE  PROXIMA_LINHA_DIREITA_ESQUERDA 
    CMP DH, "*"
    JE  FIM_PROCURA_DIREITA_ESQUERDA
    MOV SI, [PRIMEIRA_LETRA] 
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA]
    CMP [LETRA_ATUAL], SI
    JE  DIREITA_ESQUERDA_IMPRIMIR_PALAVRA
    CALL IMPRIMIR_LETRA
    INC LETRA_ATUAL
    INC DI 
    JMP IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA
DIREITA_ESQUERDA_IMPRIMIR_PALAVRA:
    MOV DH, [DI]
    MOV COR, 2 
    CMP CH, 0
    JE  IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA
    CALL IMPRIMIR_LETRA
    INC LETRA_ATUAL
    INC DI
    DEC CH 
    JMP DIREITA_ESQUERDA_IMPRIMIR_PALAVRA 
PROXIMA_LINHA_DIREITA_ESQUERDA:
    ADD DI, 2 
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CACA_PALAVRAS_DIREITA_ESQUERDA
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_ESQUERDA:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000 
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_CIMA_BAIXO
FIM_PROCURA_DIREITA_ESQUERDA: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO
;FIM DIREITA PARA ESQUERDA
              

;INICIO CIMA PARA BAIXO
PROCURA_CIMA_BAIXO:
    PUSHF  
    PUSH DX                 
    PUSH CX   
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    MOV DI, OFFSET INICIO_A
    INC DI 
PROCURANDO_CIMA_BAIXO_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH,DL
    JE  CIMA_BAIXO_BACKUP
    CMP DH, "@"
    JE  PROXIMA_COLUNA_CIMA_BAIXO
    INC PRIMEIRA_LETRA
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    INC DI
    JMP PROCURANDO_CIMA_BAIXO_M 
PROCURANDO_CIMA_BAIXO_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO
    CMP DH, DL
    JE  IGUAL_PARCIAL_PROCURANDO_CIMA_BAIXO_IGUAIS
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    MOV DI, CX
    INC DI
    JMP PROCURANDO_CIMA_BAIXO_M
PROXIMA_COLUNA_CIMA_BAIXO:
    ADD DI, 2
    PUSH BX  
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_CIMA_BAIXO_M
IGUAL_PARCIAL_PROCURANDO_CIMA_BAIXO_IGUAIS:
    INC SI
    ADD DI, [COLUNAS]
    JMP PROCURANDO_CIMA_BAIXO_PALAVRA
CIMA_BAIXO_BACKUP:
    MOV CX, DI                                                          
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_CIMA_BAIXO_PALAVRA
ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO:    
    CALL PULA_LINHA
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_CIMA_BAIXO_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_CIMA_BAIXO
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_CIMA_BAIXO 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS
I_IMPRIMIR_PALAVRA_CIMA_BAIXO:
    POP CX
IMPRIMIR_PALAVRA_CIMA_BAIXO:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_CIMA_BAIXO_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_CIMA_BAIXO_PALAVRA
    MOV COR, 7    
    PUSH CX             
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 3
    CMP [COMPARADOR], CX
    JE  I_IMPRIMIR_PALAVRA_CIMA_BAIXO
    POP CX 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_CIMA_BAIXO_PALAVRA 
PULA_LINHA_CIMA_BAIXO_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CIMA_BAIXO_PALAVRA   
PULA_LINHA_CIMA_BAIXO_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_CIMA_BAIXO_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_CIMA_BAIXO:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_BAIXO_CIMA
FIM_PROCURA_CIMA_BAIXO:
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO
;FIM IMPRIMIR DE CIMA PARA BAIXO    
 
 
;INCIO IMPRIMIR DE BAIXO PARA CIMA
PROCURA_BAIXO_CIMA:
    PUSHF  
    PUSH DX                
    PUSH CX  
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    MOV DI, OFFSET INICIO_B
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    ADD DI, CX
PROCURANDO_BAIXO_CIMA_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA_AJUSTAR
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA
    CMP DH,DL
    JE  BAIXO_CIMA_BACKUP
    CMP DH, "!"
    JE  PROXIMA_LINHA_BAIXO_CIMA
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    INC PRIMEIRA_LETRA
    DEC DI
    JMP PROCURANDO_BAIXO_CIMA_M
PROCURANDO_BAIXO_CIMA_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA_AJUSTAR
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_BAIXO_CIMA_IGUAIS
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX       
    MOV DI, CX
    DEC DI
    INC PRIMEIRA_LETRA
    CALL DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA
    JMP PROCURANDO_BAIXO_CIMA_M 
PROXIMA_LINHA_BAIXO_CIMA:
    SUB DI, 2
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_BAIXO_CIMA_M
IGUAL_PARCIAL_PROCURANDO_BAIXO_CIMA_IGUAIS:
    INC SI           
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    ADD PRIMEIRA_LETRA, CX
    POP CX
    INC DEC_PRIMEIRA_LETRA
    SUB DI, [COLUNAS]
    JMP PROCURANDO_BAIXO_CIMA_PALAVRA
BAIXO_CIMA_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_BAIXO_CIMA_PALAVRA 
DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA:
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    SUB PRIMEIRA_LETRA, CX
    POP CX 
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA
    JMP DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA
SAIR_DECREMENTAR_PRIMEIRA_LETRA_BAIXO_CIMA:
    RET
ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA_AJUSTAR:
    PUSH CX
    MOV CX, [QUANTIDADE_DE_LETRAS]
    ADD CX, [COLUNAS]
    SUB CX, 2
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA:
    CALL PULA_LINHA
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_BAIXO_CIMA_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_BAIXO_CIMA
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_BAIXO_CIMA 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS
I_IMPRIMIR_PALAVRA_BAIXO_CIMA:
    POP CX
IMPRIMIR_PALAVRA_BAIXO_CIMA:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_BAIXO_CIMA_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_BAIXO_CIMA_PALAVRA
    MOV COR, 7          
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 3
    CMP [COMPARADOR], CX
    JE  I_IMPRIMIR_PALAVRA_BAIXO_CIMA
    POP CX 
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_BAIXO_CIMA_PALAVRA 
PULA_LINHA_BAIXO_CIMA_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_BAIXO_CIMA_PALAVRA   
PULA_LINHA_BAIXO_CIMA_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_BAIXO_CIMA_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_BAIXO_CIMA:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000 
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_ESQUERDA_CIMA_DIAGONAL
FIM_PROCURA_BAIXO_CIMA:
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO
;FIM IMPRIMIR DE BAIXO PARA CIMA


;INICIO IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE CIMA PARA BAIXO
PROCURA_ESQUERDA_CIMA_DIAGONAL:
    PUSHF  
    PUSH DX
    PUSH CX 
    MOV BX, 0000        
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]     
    MOV DI, OFFSET INICIO_A
    INC DI             
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL:
    ADD DI, 2                         
    CMP DI,"*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE 
    MOV SI, PONTEIRO_PALAVRAS[BX]  
    POP BX
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
ESQUERDA_CIMA_DIAGONAL_BACKUP:
    MOV CX, DI
    INC PRIMEIRA_LETRA
    JMP PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL
PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M:
    MOV DL, [SI] 
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DH, "@"
    JE  PROXIMA_LINHA_ESQUERDA_CIMA_DIAGONAL
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL
    CMP DH,DL
    JE  ESQUERDA_CIMA_DIAGONAL_BACKUP
    INC DI
    INC PRIMEIRA_LETRA
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M 
PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL  
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_CIMA_DIAGONAL_IGUAIS
    MOV DI, CX
    INC DI
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX 
    JMP PROCURANDO_ESQUERDA_CIMA_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_CIMA_DIAGONAL_IGUAIS:
    INC SI
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    INC CX
    ADD DI, CX
    POP CX
    JMP PROCURA_PALAVRA_ESQUERDA_CIMA_DIAGONAL
ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    CALL PULA_LINHA
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_ESQUERDA_CIMA_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS
I_IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL:
    POP CX
IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_PALAVRA
    MOV COR, 7 
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    CMP [COMPARADOR], CX
    JE  I_IMPRIMIR_PALAVRA_ESQUERDA_CIMA_DIAGONAL   
    POP CX
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_PALAVRA 
PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_PALAVRA   
PULA_LINHA_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_CIMA_DIAGONAL_CACA_PALAVRAS

NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_CIMA_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_DIREITA_CIMA_DIAGONAL
FIM_PROCURA_ESQUERDA_CIMA_DIAGONAL:                           
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO
;FIM IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE CIMA PARA BAIXO   


;INICIO IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE CIMA PARA BAIXO
PROCURA_DIREITA_CIMA_DIAGONAL:
    PUSHF  
    PUSH DX
    PUSH CX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    MOV DI, OFFSET INICIO_A
    INC DI            
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL:
    ADD DI, 2                          
    CMP DI, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
DIREITA_CIMA_DIAGONAL_BACKUP:
    MOV CX, DI
    INC PRIMEIRA_LETRA 
    JMP PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL
PROCURANDO_DIREITA_CIMA_DIAGONAL_M:
    MOV DL, [SI] 
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH, "@"
    JE  PROXIMA_LINHA_DIREITA_CIMA_DIAGONAL
    CMP DH, "*"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL
    CMP DH,DL
    JE  DIREITA_CIMA_DIAGONAL_BACKUP
    INC DI
    INC PRIMEIRA_LETRA
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M 
PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL  
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_CIMA_DIAGONAL_IGUAIS
    MOV DI, CX
    INC DI
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX  
    JMP PROCURANDO_DIREITA_CIMA_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_CIMA_DIAGONAL_IGUAIS:
    INC SI
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    DEC CX
    ADD DI, CX
    POP CX
    JMP PROCURA_PALAVRA_DIREITA_CIMA_DIAGONAL
ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL:
    CALL PULA_LINHA
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_DIREITA_CIMA_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS
I_IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL:
    POP CX
IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_DIREITA_CIMA_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_CIMA_DIAGONAL_PALAVRA
    MOV COR, 7
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 4
    CMP [COMPARADOR], CX
    JE  I_IMPRIMIR_PALAVRA_DIREITA_CIMA_DIAGONAL 
    POP CX
    CALL IMPRIMIR_LETRA 
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_PALAVRA 
PULA_LINHA_DIREITA_CIMA_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_PALAVRA   
PULA_LINHA_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_CIMA_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_ESQUERDA_BAIXO_DIAGONAL
FIM_PROCURA_DIREITA_CIMA_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO
;FIM IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE CIMA PARA BAIXO
                                                               

;INICIO IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE BAIXO PARA CIMA
PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    PUSHF 
    PUSH DX   
    PUSH CX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    MOV DI, OFFSET INICIO_B
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    ADD DI, CX
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
ESQUERDA_BAIXO_DIAGONAL_PUSH:
    MOV CX, DI
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA 
PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL_AJUSTAR 
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL
    CMP DH,DL
    JE  ESQUERDA_BAIXO_DIAGONAL_PUSH 
    CMP DH, "!"
    JE  PROXIMA_LINHA_ESQUERDA_BAIXO_DIAGONAL
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    DEC DI 
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL_AJUSTAR 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_IGUAIS
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    MOV DI, CX
    DEC DI
    CALL DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_IGUAIS:
    INC SI 
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 3
    ADD PRIMEIRA_LETRA, CX
    INC DEC_PRIMEIRA_LETRA
    ADD CX, 2
    SUB DI, CX
    POP CX
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA
PROXIMA_LINHA_ESQUERDA_BAIXO_DIAGONAL:
    SUB DI, 2
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_ESQUERDA_BAIXO_DIAGONAL_M  
DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL:
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 3
    SUB PRIMEIRA_LETRA, CX
    POP CX
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL
    JMP DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL
SAIR_DECREMENTAR_PRIMEIRA_LETRA_ESQUERDA_BAIXO_DIAGONAL:   
    RET
ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL_AJUSTAR:
    PUSH CX
    MOV CX, [QUANTIDADE_DE_LETRAS]
    ADD CX, [COLUNAS]
    SUB CX, 3
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    CALL PULA_LINHA
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_ESQUERDA_BAIXO_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS
I_IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL:
    POP CX
IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_PALAVRA
    MOV COR, 7   
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 4
    CMP [COMPARADOR], CX
    JE  I_IMPRIMIR_PALAVRA_ESQUERDA_BAIXO_DIAGONAL 
    POP CX
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA 
PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_PALAVRA   
PULA_LINHA_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_ESQUERDA_BAIXO_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_ESQUERDA_BAIXO_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000 
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX
    POPF
    JMP PROCURA_DIREITA_BAIXO_DIAGONAL
FIM_PROCURA_ESQUERDA_BAIXO_DIAGONAL: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000  
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO 
;FIM IMPRIMIR DIAGONAL ESQUERDA PARA DIREITA DE BAIXO PARA CIMA


;INICIO IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE BAIXO PARA CIMA
PROCURA_DIREITA_BAIXO_DIAGONAL:
    PUSHF 
    PUSH DX
    PUSH CX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    MOV DI, OFFSET INICIO_B
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    ADD DI, CX
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
DIREITA_BAIXO_DIAGONAL_BACKUP:
    MOV CX, DI
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA 
PROCURANDO_DIREITA_BAIXO_DIAGONAL_M:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL_AJUSTES 
    CMP DH, "$"
    JE  NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL
    CMP DH, "!"
    JE  PROXIMA_LINHA_DIREITA_BAIXO_DIAGONAL
    CMP DH,DL
    JE  DIREITA_BAIXO_DIAGONAL_BACKUP
    PUSH BX 
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    DEC DI
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    MOV DL, [SI]
    MOV DH, [DI]
    CMP DL, 0
    JE  ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL_AJUSTES 
    CMP DH,DL
    JE  IGUAL_PARCIAL_PROCURANDO_DIREITA_BAIXO_DIAGONAL_IGUAIS
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    MOV DI, CX
    DEC DI
    CALL DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL
    INC PRIMEIRA_LETRA
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M
IGUAL_PARCIAL_PROCURANDO_DIREITA_BAIXO_DIAGONAL_IGUAIS:
    INC SI
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    DEC CX
    ADD PRIMEIRA_LETRA, CX
    INC DEC_PRIMEIRA_LETRA
    ADD CX, 2
    SUB DI, CX
    POP CX
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_PALAVRA
PROXIMA_LINHA_DIREITA_BAIXO_DIAGONAL:
    SUB DI, 2
    PUSH BX
    MOV BX, 0000
    MOV BX, INDICE
    MOV SI, PONTEIRO_PALAVRAS[BX]
    POP BX
    JMP PROCURANDO_DIREITA_BAIXO_DIAGONAL_M 
DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL:
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    DEC CX
    SUB PRIMEIRA_LETRA, CX
    POP CX
    DEC DEC_PRIMEIRA_LETRA
    CMP DEC_PRIMEIRA_LETRA, 0
    JE  SAIR_DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL
    JMP DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL
SAIR_DECREMENTA_PRIMEIRA_LETRA_DIREITA_BAIXO_DIAGONAL:
    RET
ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL_AJUSTES:
    PUSH CX
    MOV CX, [QUANTIDADE_DE_LETRAS]
    ADD CX, [COLUNAS]
    DEC CX
    SUB CX, [PRIMEIRA_LETRA]
    MOV PRIMEIRA_LETRA, CX
    POP CX
ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL:
    CALL PULA_LINHA
    MOV DI, OFFSET INICIO_A
    INC DI
IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    MOV COR, 7
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS
    CMP DH, "*"
    JE  FIM_PROCURA_DIREITA_BAIXO_DIAGONAL
    INC LETRA_ATUAL
    MOV CH, [QUANTIDADE_DE_LETRAS_PALAVRA] 
    MOV SI, [PRIMEIRA_LETRA]
    CMP [LETRA_ATUAL], SI
    JE  IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL 
    CALL IMPRIMIR_LETRA
    INC DI   
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS
I_IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL:
    POP CX
IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL:
    MOV DH, [DI]
    MOV COR, 2
    CALL IMPRIMIR_LETRA
    INC DI                                 
    DEC CH 
    CMP CH, 0
    JE  IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS 
    MOV COMPARADOR, 0000
IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    MOV DH, [DI]
    CMP DH, "@"
    JE  PULA_LINHA_DIREITA_BAIXO_DIAGONAL_PALAVRA
    MOV COR, 7 
    PUSH CX
    MOV CX, 0000
    MOV CX, [COLUNAS]
    SUB CX, 2
    CMP [COMPARADOR], CX
    JE  I_IMPRIMIR_PALAVRA_DIREITA_BAIXO_DIAGONAL 
    POP CX
    CALL IMPRIMIR_LETRA
    INC COMPARADOR
    INC DI
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_PALAVRA 
PULA_LINHA_DIREITA_BAIXO_DIAGONAL_PALAVRA:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_PALAVRA   
PULA_LINHA_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS:
    ADD DI, 2
    CALL PULA_LINHA_CACA_PALAVRAS
    JMP IMPRIMINDO_DIREITA_BAIXO_DIAGONAL_CACA_PALAVRAS
NAO_ACHOU_SUBSTRING_PROCURA_DIREITA_BAIXO_DIAGONAL:
    MOV PRIMEIRA_LETRA, 0000
    MOV LETRA_ATUAL, 0000 
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX
    POPF
    JMP INICIO
FIM_PROCURA_DIREITA_BAIXO_DIAGONAL: 
    MOV PRIMEIRA_LETRA, 0000 
    MOV LETRA_ATUAL, 0000  
    MOV DEC_PRIMEIRA_LETRA, 0000
    POP CX
    POP DX 
    POPF
    CALL PULA_LINHA
    MOV SI, OFFSET VOLTAR_INICIO
    CALL PRINT_STRING
    MOV DI, OFFSET RESPOSTA
    CALL GET_STRING
    JMP INICIO 
;FIM IMPRIMIR DIAGONAL DIREITA PARA ESQUERDA DE BAIXO PARA CIMA

                                                               
;METODOS UNIVERSAIS

;LER QUANTIDADE DE LETRAS DE UM CACA PALAVRAS
INICIO_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS:    
    PUSHF
    PUSH CX
    PUSH DX
    MOV DI, OFFSET INICIO_A
    MOV CX, 0000
QUANTIDADE_DE_LETRAS_CACA_PALAVRAS_LINHAS:
    MOV DH, [DI]    
    INC CL
    CMP DH, "@"
    JE INICIO_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS_TUDO
    INC DI
    JMP QUANTIDADE_DE_LETRAS_CACA_PALAVRAS_LINHAS
INICIO_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS_TUDO:
    MOV COLUNAS, CX
    MOV DI, OFFSET INICIO_A 
    INC DI
    MOV CX, 0000
QUANTIDADE_DE_LETRAS_CACA_PALAVRAS:
    MOV DH, [DI]
    CMP DH, "@"
    JE PULA_LINHA_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS
    CMP DH,"*"
    JE FIM_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS       
    INC CX
    INC DI
    JMP QUANTIDADE_DE_LETRAS_CACA_PALAVRAS 
PULA_LINHA_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS:
    ADD DI, 2
    JMP QUANTIDADE_DE_LETRAS_CACA_PALAVRAS
FIM_QUANTIDADE_DE_LETRAS_CACA_PALAVRAS:
    MOV QUANTIDADE_DE_LETRAS, CX
    POP DX
    POP CX
    POPF
    RET
;FIM LER QUANTIDADE DE LETRAS DE UM CACA PALAVRAS


;IMPRIMIR INTERFACE
INICIO_IMPRIMIR_INTERFACE:
    PUSH DX
IMPRIMIR_INTERFACE:
    MOV DL, [SI]
    CMP DL, 0
    JE  FIM_IMPRIMIR_INTERFACE
    CALL IMPRIMIR_LETRA 
    INC SI
    JMP IMPRIMIR_INTERFACE
FIM_IMPRIMIR_INTERFACE:
    POP DX
    RET
          
          
;IMPRIMIR LETRA COLORIDA
IMPRIMIR_LETRA:
    PUSH AX
    PUSH DX
    PUSH BX
    PUSH CX
    MOV AH, 9
    MOV BH, 0
    MOV AL, DH
    MOV BL, COR
    MOV CX, 1 
    INT 10H
    POP CX
    POP BX
    POP DX
    POP AX
AVANCAR_COLUNA:
    PUSH AX
    PUSH CX 
    PUSH DX
    MOV AH, 3
    INT 10H
    MOV AH, 2 
    INC DL
    INT 10H
    POP DX
    POP CX
    POP AX 
    RET

;PULAR LINHA LETRA COLORIDA
PULA_LINHA_CACA_PALAVRAS:
    PUSHF
    PUSH AX
    PUSH CX
    PUSH DX
    MOV  AH, 3
    INT 10H
    MOV  AH, 2
    INC  DH
    MOV  DL, 0
    INT 10H 
    POP  DX
    POP  CX
    POP  AX
    POPF
    RET    
               
;PULAR LINHA    
PULA_LINHA:                      
    PUSHF
    PUSH AX
    PUSH DX
    MOV AH,2
    MOV DL,13        
    INT 21H
    MOV AH,2
    MOV DL,10
    INT 21H
    POP DX        
    POP AX
    POPF
    RET     

;FINALIZA O PROGRAMA     
FINALIZAR_PROGRAMA:                                                                             
    MOV AH,4CH
    MOV AL, 0
    INT 21H
 
 
;RESET NA TELA
CLEAR_SCREEN:
    PUSH AX
    MOV  AH, 0 
    INT  10H
    POP  AX
    RET
     
     
;VARIAVEIS AUXILIARES
PRIMEIRA_LETRA DW 0 ,0
NAO_ACHOU DB "NAO ACHOU" ,0
LETRA_ATUAL DW 0 ,0
COMPARADOR DW 0 ,0
DEC_PRIMEIRA_LETRA DW 0 ,0
OPCAO_CACA_PALAVRAS DB 00 ,0
 
 
;PALAVRA A BUSCAR
QUANTIDADE_DE_LETRAS_PALAVRA DB 00
 
 
;VARIAVEIS PARA INTERFACE
COR DB 7 
INICIAR_PROGRAMA DB "INICIAR PROGRAMA" ,0 
PROCURANDO_PALAVRA DB "PROCURANDO PALAVRA " ,0
_TAMANHO DB " - TAMANHO " ,0 
VOLTAR_INICIO DB "PROCURAR PROXIMA PALAVRA" ,0 
RESPOSTA DB "" ,0


;NOME DOS ALUNOS 
ALUNO  DW "ALUNOS:" ,0
ALUNO1 DW "LUIZ HENRIQUE MARTENDAL" ,0
ALUNO2 DW "GABRIEL CARDOSO DE SOUZA" ,0
ALUNO3 DW "GUSTAVO WESTPHAL ANTUNES" ,0


;VARIAVEIS PARA CADA CACA PALAVRA
COLUNAS DW 0000 ,0
QUANTIDADE_DE_LETRAS DW 0000 ,0


PONTEIRO_PALAVRAS DW P0,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,P17,P18,P19,P20,P21,P22,P23,P24,P25,P26,P27,P28

P0  DB "ADMINISTRACAO",0
P1  DB "AMBULATORIO",0
P2  DB "ANDADOR",0
P3  DB "CAMA",0
P4  DB "CAPELA",0
P5  DB "COPEIRO",0
P6  DB "ELETROCARDIOGRAMA",0
P7  DB "ELEVADOR",0
P8  DB "EMERGENCIA",0
P9  DB "FARMACIA",0
P10 DB "INJECAO",0
P11 DB "LABORATORIO",0
P12 DB "LANCHONETE",0
P13 DB "MACA",0
P14 DB "MULETA",0
P15 DB "PACIENTE",0
P16 DB "PARTO",0
P17 DB "POLTRONA",0
P18 DB "PRONTOSOCORRO",0
P19 DB "PSICOLOGO",0
P20 DB "RECEITA",0
P21 DB "RECEPCIONISTA",0
P22 DB "TELEFONE",0
P23 DB "TOMOGRAFIA",0
P24 DB "TRANSFUSAODESANGUE",0
P25 DB "VELORIO",0
P26 DB "VISITANTE",0
P27 DB "OBITO",0 
P28 DB 0  ; INDICADOR DE FIM DE PALAVRAS...TEM QUE PROCURAR



            DB 0,"#$$$$$$$$$$$$$$$$$$$$@"
INICIO_A    DB   "!DIDOIROTAROBALTEACET@"
            DB   "!OACARTSINIMDAMLEATLE@"
            DB   "!FETPRONTOSOCORROEOEL@"
            DB   "!TOUTITDTSOIEPOOOOMTE@"
            DB   "!DAEGANDADORSSNVBMORF@"
            DB   "!EAMTNLGEVREEIMIIAGOO@"
            DB   "!ETEBEAORIEPOCAETIRCN@"
            DB   "!REASUNSOFRLAOVTONAAE@"
            DB   "!ELLVOLOEISAELDNFJFRV@"
	        DB   "!CUSAMTAHDRINOEAAEIDP@"
		    DB   "!EMRHDMETCOOIGTTRCAIO@"
		    DB   "!PCAIAOAMONALOMIMAJOL@"
		    DB   "!CAICDDSAERASEOSAOEGT@"
	       	DB   "!IPCSSCERIRILUVICASRR@"
		    DB   "!OEAIIMEETOGOMFVIRTAO@"
	    	DB   "!NLAUECESGPDEEUSAADMN@"
		    DB   "!IADDENISUAMSNTSNMNAA@"
		    DB   "!SETIRRTLARSQCCCEAERA@"
		    DB   "!TMTSANAETTCERAIACRAO@"
INICIO_B	DB   "!AARMASMRGOOTGIEAARTT@"
            DB   "*********************#",0


		    
		    
